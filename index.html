<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Quick QR – Styled + Logo (Extended)</title>
<meta name="color-scheme" content="dark light" />
<style>
  :root{
    --bg:#0b1220; --panel:#0f172a; --ink:#e6edf7; --muted:#9fb0c9; --accent:#60a5fa; --border:#1f2a44;
    --radius:16px; --gap:14px; --shadow:0 6px 26px rgba(0,0,0,.25), 0 2px 10px rgba(0,0,0,.2);
  }
  @media (prefers-color-scheme: light){
    :root{ --bg:#f7f9fc; --panel:#ffffff; --ink:#0b1220; --muted:#5a6b86; --border:#dbe3f2; --accent:#2563eb }
  }
  *{ box-sizing:border-box }
  html,body{ height:100% }
  body{
    margin:0;
    background:radial-gradient(1000px 600px at 20% -10%, rgba(96,165,250,.15), transparent),
               radial-gradient(900px 600px at 120% 10%, rgba(99,102,241,.12), transparent),
               var(--bg);
    color:var(--ink);
    font:15px/1.5 ui-sans-serif, system-ui, -apple-system,"Segoe UI",Roboto,Helvetica,Arial;
  }
  .wrap{ max-width:1200px; margin:24px auto 80px; padding:0 14px }
  .hero{ text-align:center; margin:8px 0 20px; }
  .title{ font-size:clamp(24px,4vw,38px); font-weight:800; margin:0 0 6px }
  .subtitle{ color:var(--muted); margin:0; font-size:clamp(14px,2vw,16px) }
  .grid{ display:grid; grid-template-columns:1.25fr .9fr; gap:20px; align-items:start }
  @media (max-width:1000px){ .grid{ grid-template-columns:1fr } }
  .card{ background:var(--panel); border:1px solid var(--border); border-radius:var(--radius);
         padding:18px; box-shadow:var(--shadow) }
  .row{ display:grid; grid-template-columns:1fr; gap:var(--gap) }
  .cols-2{ grid-template-columns:1fr 1fr }
  .cols-3{ grid-template-columns:1fr 1fr 1fr }
  .cols-4{ grid-template-columns:1fr 1fr 1fr 1fr }
  @media (max-width:700px){ .cols-2,.cols-3,.cols-4{ grid-template-columns:1fr } }
  label{ font-weight:600; font-size:13px; color:var(--muted); display:block; margin:0 0 6px }
  input[type="text"], input[type="url"], input[type="number"], input[type="range"],
  select, input[type="color"]{
    width:100%; padding:11px 12px; border-radius:12px; border:1px solid var(--border);
    background:#0000; color:var(--ink); outline:none;
  }
  input:focus, select:focus{
    border-color:color-mix(in oklab, var(--accent) 60%, var(--border));
    box-shadow:0 0 0 4px color-mix(in oklab, var(--accent) 18%, transparent);
  }
  .file{ display:flex; gap:10px; align-items:center; flex-wrap:wrap }
  .btn{
    display:inline-flex; align-items:center; justify-content:center; gap:8px;
    padding:12px 14px; font-weight:700;
    background:linear-gradient(180deg, color-mix(in oklab, var(--accent) 90%, #fff 10%), var(--accent));
    color:white; border:none; border-radius:12px; cursor:pointer;
  }
  .btn.secondary{ background:#0000; color:var(--ink); border:1px solid var(--border) }
  .btn.ghost{ background:#0000; color:var(--muted); border:1px dashed var(--border) }
  .btnbar{ display:flex; flex-wrap:wrap; gap:10px; align-items:center }
  .qr-box{ display:grid; place-items:center; border-radius:12px; padding:18px;
           min-height:380px; border:1px solid var(--border) }
  .qr-wrap{ background:var(--panel); padding:16px; border-radius:12px; border:1px solid var(--border) }
  .qr-wrap canvas, .qr-wrap img{ display:block; height:auto; max-width:100% }
  .note{ color:var(--muted); font-size:13px }
  .footer{ margin-top:18px; color:var(--muted); text-align:center; font-size:12px }
  .inline{ display:flex; align-items:center; gap:10px }
  .rangeval{ min-width:42px; text-align:right; font-variant-numeric:tabular-nums }
</style>
</head>
<body>
<div class="wrap">
  <header class="hero">
    <h1 class="title">Quick&nbsp;QR — Styled</h1>
    <p class="subtitle">Customize appearance and insert a logo in the middle.</p>
  </header>

  <div class="grid">
    <!-- Controls -->
    <section class="card">
      <form id="qrForm" autocomplete="on">
        <div class="row">
          <label for="text">Text or URL</label>
          <input id="text" type="text" placeholder="https://example.com (or any text)" />
        </div>

        <div class="row cols-4" style="margin-top:8px">
          <div><label for="size">Size</label>
            <select id="size"><option value="256" selected>256</option>
              <option value="384">384</option><option value="512">512</option>
              <option value="768">768</option><option value="1024">1024</option></select></div>
          <div><label for="margin">Margin</label><input id="margin" type="number" value="8" min="0" step="1"/></div>
          <div><label for="ecc">ECC</label>
            <select id="ecc"><option value="L">L</option><option value="M" selected>M</option>
              <option value="Q">Q</option><option value="H">H</option></select></div>
          <div><label for="bg">Background</label><input id="bg" type="color" value="#ffffff"/></div>
        </div>

        <div class="row cols-3" style="margin-top:8px">
          <div><label for="fg">Dots color</label><input id="fg" type="color" value="#000000"/></div>
          <div><label for="dotType">Dots style</label>
            <select id="dotType"><option value="square">square</option>
              <option value="rounded" selected>rounded</option>
              <option value="dots">dots</option><option value="classy">classy</option></select></div>
          <div><label for="gradient">Gradient</label>
            <select id="gradient"><option value="none" selected>none</option>
              <option value="linear">linear</option><option value="radial">radial</option></select></div>
        </div>

        <div class="row cols-3">
          <div><label for="cornerSq">Corner squares</label>
            <select id="cornerSq"><option value="square">square</option>
              <option value="extra-rounded" selected>extra-rounded</option><option value="dot">dot</option></select></div>
          <div><label for="cornerDot">Corner dots</label>
            <select id="cornerDot"><option value="square">square</option><option value="dot" selected>dot</option></select></div>
          <div><label for="cornerColor">Corner color</label><input id="cornerColor" type="color" value="#000000"/></div>
        </div>

        <div class="row" style="margin-top:6px">
          <div class="inline">
            <label for="imgUrl" style="min-width:120px">Center image URL</label>
            <input id="imgUrl" type="url" placeholder="https://site.com/logo.png" />
            <button type="button" class="btn secondary" id="applyUrl">Apply</button>
          </div>
          <div class="file">
            <input id="imgFile" type="file" accept="image/*" />
            <button type="button" class="btn secondary" id="clearImg">Remove</button>
          </div>
          <div class="inline">
            <label for="imgScale" style="min-width:120px">Image size</label>
            <input id="imgScale" type="range" min="0.1" max="0.8" step="0.01" value="0.28" />
            <span class="rangeval" id="imgScaleVal">0.28</span>
            <label class="inline"><input type="checkbox" id="hideDots" style="margin-left:10px" checked>
              Hide dots behind image</label>
          </div>
        </div>

        <div class="btnbar" style="margin-top:12px">
          <button type="submit" class="btn">Generate / Update</button>
          <button type="button" class="btn secondary" id="copyBtn">Copy PNG</button>
          <button type="button" class="btn secondary" id="pngBtn">Download PNG</button>
          <span class="note" id="status"></span>
        </div>
      </form>
    </section>

    <!-- Output -->
    <section class="card">
      <div class="qr-box">
        <div class="qr-wrap" id="qrcode"></div>
      </div>
      <div class="footer">All generation happens locally in your browser.</div>
    </section>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/qr-code-styling@1.6.0/lib/qr-code-styling.js"></script>
<script>
(function(){
  const $=(id)=>document.getElementById(id);
  const text=$('text'), size=$('size'), margin=$('margin'), ecc=$('ecc'),
        fg=$('fg'), bg=$('bg'), dotType=$('dotType'), gradient=$('gradient'),
        cornerSq=$('cornerSq'), cornerDot=$('cornerDot'), cornerColor=$('cornerColor'),
        imgUrl=$('imgUrl'), imgFile=$('imgFile'), applyUrl=$('applyUrl'), clearImg=$('clearImg'),
        imgScale=$('imgScale'), imgScaleVal=$('imgScaleVal'), hideDots=$('hideDots'),
        form=$('qrForm'), box=$('qrcode'), status=$('status'),
        copyBtn=$('copyBtn'), pngBtn=$('pngBtn');
  let currentImage='', qr;

  function setStatus(msg,err=false){status.textContent=msg||'';status.className=err?'note err':'note';}
  function dotsOptions(){
    if(gradient.value==='none') return {color:fg.value,type:dotType.value};
    return {gradient:{type:gradient.value,rotation:0,
      colorStops:[{offset:0,color:fg.value},{offset:1,color:cornerColor.value}]},
      type:dotType.value};
  }
  function cornerOptions(){
    return {cornersSquareOptions:{type:cornerSq.value,color:cornerColor.value},
            cornersDotOptions:{type:cornerDot.value,color:cornerColor.value}};
  }
  function buildConfig(){
    return {width:+size.value,height:+size.value,data:text.value.trim()||' ',
      margin:Math.max(0,+margin.value|0),
      qrOptions:{errorCorrectionLevel:ecc.value},
      backgroundOptions:{color:bg.value},
      dotsOptions:dotsOptions(),...cornerOptions(),
      image:currentImage||undefined,
      imageOptions:{imageSize:+imgScale.value,hideBackgroundDots:hideDots.checked}};
  }
  function ensureQR(){if(!qr){qr=new QRCodeStyling(buildConfig());qr.append(box);}}
  async function updateQR(){if(!text.value.trim()){setStatus('Enter text or URL',true);return;}
    ensureQR();await qr.update(buildConfig());setStatus('');}

  form.addEventListener('submit',e=>{e.preventDefault();updateQR();});
  applyUrl.addEventListener('click',async()=>{currentImage=imgUrl.value.trim();await updateQR();});
  imgFile.addEventListener('change',()=>{
    const f=imgFile.files?.[0];if(!f)return;
    const reader=new FileReader();
    reader.onload=async()=>{currentImage=String(reader.result);imgUrl.value='';await updateQR();};
    reader.readAsDataURL(f);
  });
  clearImg.addEventListener('click',async()=>{currentImage='';imgUrl.value='';imgFile.value='';await updateQR();});
  imgScale.addEventListener('input',()=>{imgScaleVal.textContent=(+imgScale.value).toFixed(2);});
  copyBtn.addEventListener('click',async()=>{
    try{const blob=await qr.getRawData('png');
      await navigator.clipboard.write([new ClipboardItem({'image/png':blob})]);
      setStatus('Copied PNG ✅');setTimeout(()=>setStatus(''),1500);}
    catch{setStatus('Copy failed. Try Download.',true);}
  });
  pngBtn.addEventListener('click',()=>qr.download({name:'qr',extension:'png'}));
})();
</script>
</body>
</html>
