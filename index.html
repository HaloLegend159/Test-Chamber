<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>T-Shirt Mockup Studio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg: #0f172a;
      --panel: #111827;
      --accent: #38bdf8;
      --accent-soft: rgba(56, 189, 248, 0.15);
      --text: #e5e7eb;
      --text-muted: #9ca3af;
      --border: #1f2937;
      --radius-lg: 18px;
      --radius-md: 10px;
      --shadow-soft: 0 18px 40px rgba(15, 23, 42, 0.7);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Inter", sans-serif;
      background: radial-gradient(circle at top, #1f2937 0, #020617 38%, #020617 100%);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }

    .app-shell {
      width: 100%;
      max-width: 1120px;
      background: linear-gradient(135deg, #020617 0%, #020617 40%, #020617 100%);
      border-radius: 32px;
      border: 1px solid rgba(148, 163, 184, 0.2);
      box-shadow: var(--shadow-soft);
      padding: 24px 28px 28px;
      display: grid;
      grid-template-columns: minmax(0, 3fr) minmax(0, 2.2fr);
      gap: 24px;
    }

    @media (max-width: 900px) {
      .app-shell {
        grid-template-columns: 1fr;
        padding: 16px;
        border-radius: 24px;
      }
    }

    .header {
      grid-column: 1 / -1;
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 6px;
      gap: 12px;
    }

    .title-group h1 {
      font-size: 24px;
      margin: 0 0 4px;
      letter-spacing: 0.03em;
    }

    .title-group p {
      margin: 0;
      font-size: 13px;
      color: var(--text-muted);
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 12px;
      border-radius: 999px;
      background: rgba(15, 118, 110, 0.06);
      border: 1px solid rgba(45, 212, 191, 0.3);
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: #a5f3fc;
      white-space: nowrap;
    }

    .pill-dot {
      width: 7px;
      height: 7px;
      border-radius: 50%;
      background: #22c55e;
      box-shadow: 0 0 10px rgba(34, 197, 94, 0.9);
    }

    /* Canvas Panel */
    .preview-card {
      background: radial-gradient(circle at top, #1e293b 0, #020617 40%);
      border-radius: var(--radius-lg);
      border: 1px solid rgba(148, 163, 184, 0.25);
      padding: 18px;
      position: relative;
      overflow: hidden;
    }

    .preview-card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      font-size: 12px;
      color: var(--text-muted);
    }

    .preview-tag {
      padding: 3px 9px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.14em;
    }

    .canvas-wrapper {
      background: radial-gradient(circle at top, #0b1120 0, #020617 50%);
      border-radius: 18px;
      border: 1px solid rgba(15, 23, 42, 0.9);
      padding: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    canvas {
      max-width: 100%;
      height: auto;
      border-radius: 16px;
      background: transparent;
      cursor: default;
    }

    .canvas-hint {
      position: absolute;
      bottom: 12px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 11px;
      color: var(--text-muted);
      background: rgba(15, 23, 42, 0.9);
      padding: 5px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      backdrop-filter: blur(10px);
      pointer-events: none;
    }

    /* Controls Panel */
    .control-panel {
      background: var(--panel);
      border-radius: var(--radius-lg);
      border: 1px solid var(--border);
      padding: 16px 16px 18px;
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .section-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--text-muted);
      margin-bottom: 6px;
    }

    .control-group {
      background: #020617;
      border-radius: var(--radius-md);
      border: 1px solid var(--border);
      padding: 10px 11px;
    }

    .control-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      margin-bottom: 8px;
    }

    .control-row:last-child {
      margin-bottom: 0;
    }

    .control-label {
      font-size: 13px;
      color: var(--text-muted);
    }

    .control-sub {
      font-size: 11px;
      color: #6b7280;
    }

    input[type="color"] {
      appearance: none;
      -webkit-appearance: none;
      border: 1px solid rgba(148, 163, 184, 0.6);
      border-radius: 999px;
      width: 38px;
      height: 22px;
      padding: 0;
      background: transparent;
      cursor: pointer;
    }

    input[type="color"]::-webkit-color-swatch {
      border: none;
      border-radius: 999px;
    }

    input[type="color"]::-moz-color-swatch {
      border: none;
      border-radius: 999px;
    }

    .file-input-wrapper {
      position: relative;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 7px 10px;
      border-radius: 999px;
      border: 1px dashed rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.7);
      font-size: 12px;
      color: var(--text-muted);
      cursor: pointer;
      white-space: nowrap;
    }

    .file-input-wrapper span.icon {
      font-size: 14px;
    }

    #imageUpload {
      position: absolute;
      inset: 0;
      opacity: 0;
      cursor: pointer;
    }

    input[type="range"] {
      width: 100%;
      accent-color: var(--accent);
    }

    .footer-controls {
      display: flex;
      gap: 8px;
      margin-top: 4px;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 9px 14px;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition: transform 0.08s ease, box-shadow 0.12s ease, background 0.12s ease;
    }

    button.primary {
      background: linear-gradient(135deg, #0ea5e9, #22c55e);
      color: #0b1120;
      box-shadow: 0 10px 30px rgba(56, 189, 248, 0.5);
      flex: 1.1;
    }

    button.primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 16px 40px rgba(56, 189, 248, 0.7);
    }

    button.primary:active {
      transform: translateY(0);
      box-shadow: 0 8px 20px rgba(56, 189, 248, 0.5);
    }

    button.secondary {
      background: rgba(15, 23, 42, 0.9);
      color: var(--text);
      border: 1px solid rgba(148, 163, 184, 0.5);
      flex: 0.9;
    }

    button.secondary:hover {
      background: rgba(15, 23, 42, 1);
      transform: translateY(-1px);
    }

    button.secondary:active {
      transform: translateY(0);
    }

    .small-text {
      font-size: 11px;
      color: var(--text-muted);
      margin-top: 4px;
      line-height: 1.5;
    }

    .kbd {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 1px 6px;
      border-radius: 4px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      background: rgba(15, 23, 42, 0.8);
      font-size: 10px;
      margin: 0 2px;
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <header class="header">
      <div class="title-group">
        <h1>T-Shirt Mockup Studio</h1>
        <p>Pick a color, drop your design, drag it into place, and export a clean PNG.</p>
      </div>
      <div class="pill">
        <span class="pill-dot"></span>
        LIVE CANVAS ¬∑ CLIENT-SIDE
      </div>
    </header>

    <!-- Canvas / Preview -->
    <section class="preview-card">
      <div class="preview-card-header">
        <div class="preview-tag">Preview</div>
        <span>1:1 export ¬∑ transparent background</span>
      </div>

      <div class="canvas-wrapper">
        <canvas id="shirtCanvas" width="700" height="800"></canvas>
      </div>

      <div class="canvas-hint">
        Upload an image, then drag it around the shirt ¬∑ Scroll wheel = zoom
      </div>
    </section>

    <!-- Controls -->
    <section class="control-panel">
      <div>
        <div class="section-label">Fabric & Color</div>
        <div class="control-group">
          <div class="control-row">
            <div>
              <div class="control-label">Shirt color</div>
              <div class="control-sub">Live updates on the canvas</div>
            </div>
            <input type="color" id="shirtColor" value="#ffffff" />
          </div>
        </div>
      </div>

      <div>
        <div class="section-label">Artwork</div>
        <div class="control-group">
          <div class="control-row">
            <div>
              <div class="control-label">Upload design</div>
              <div class="control-sub">PNG with transparency works best</div>
            </div>
            <label class="file-input-wrapper">
              <span class="icon">üìÅ</span>
              <span>Choose file</span>
              <input type="file" id="imageUpload" accept="image/*" />
            </label>
          </div>
        </div>
      </div>

      <div>
        <div class="section-label">Placement</div>
        <div class="control-group">
          <div class="control-row">
            <div>
              <div class="control-label">Design size</div>
              <div class="control-sub">Drag slider or use mouse wheel on canvas</div>
            </div>
          </div>
          <input type="range" id="imageScale" min="20" max="200" value="100" />
        </div>
      </div>

      <div>
        <div class="section-label">Export</div>
        <div class="control-group">
          <div class="footer-controls">
            <button class="secondary" id="resetBtn" type="button">
              Reset
            </button>
            <button class="primary" id="downloadBtn" type="button">
              Download PNG
            </button>
          </div>
          <div class="small-text">
            Tip: Drag your design with the mouse. Use the scroll wheel to fine-tune the size.
            Hold <span class="kbd">Shift</span> while scrolling to scale faster.
          </div>
        </div>
      </div>
    </section>
  </div>

  <script>
    const canvas = document.getElementById("shirtCanvas");
    const ctx = canvas.getContext("2d");

    const shirtColorInput = document.getElementById("shirtColor");
    const imageUploadInput = document.getElementById("imageUpload");
    const imageScaleInput = document.getElementById("imageScale");
    const downloadBtn = document.getElementById("downloadBtn");
    const resetBtn = document.getElementById("resetBtn");

    let shirtColor = shirtColorInput.value;
    let designImage = null;
    let designLoaded = false;

    // We'll store original natural size of image
    let imgNaturalWidth = 0;
    let imgNaturalHeight = 0;

    // Position and scale are in "canvas space"
    let designScale = 1.0; // 1.0 = 100% slider
    let designCenter = { x: canvas.width / 2, y: canvas.height / 2 - 40 };

    // Drag state
    let isDragging = false;
    let dragOffset = { x: 0, y: 0 };

    // --- Drawing the shirt shape ---
    function drawShirtBase(color) {
      ctx.save();
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Background (transparent, so do nothing here if you want transparency)
      // Draw a subtle shadow / grounding
      ctx.fillStyle = "rgba(15,15,30,0.65)";
      ctx.beginPath();
      ctx.ellipse(canvas.width / 2, canvas.height - 60, 160, 26, 0, 0, Math.PI * 2);
      ctx.fill();

      // Shirt body (simple stylized t-shirt)
      const cx = canvas.width / 2;
      const topY = 120;
      const bodyWidth = 260;
      const bodyHeight = 380;
      const sleeveWidth = 120;
      const neckWidth = 90;
      const neckDepth = 30;
      const radius = 22;

      ctx.fillStyle = color;
      ctx.strokeStyle = "rgba(0,0,0,0.12)";
      ctx.lineWidth = 3;

      ctx.beginPath();
      // Left sleeve top
      ctx.moveTo(cx - bodyWidth / 2 - sleeveWidth / 2, topY + 40);
      ctx.lineTo(cx - bodyWidth / 2, topY);
      // Across shoulders to neckline
      ctx.lineTo(cx - neckWidth / 2, topY);
      ctx.quadraticCurveTo(cx, topY + neckDepth, cx + neckWidth / 2, topY);
      // Right shoulder & sleeve
      ctx.lineTo(cx + bodyWidth / 2, topY);
      ctx.lineTo(cx + bodyWidth / 2 + sleeveWidth / 2, topY + 40);
      // Sleeve ends
      ctx.lineTo(cx + bodyWidth / 2 + sleeveWidth / 2 - 24, topY + 120);
      ctx.lineTo(cx + bodyWidth / 2, topY + 90);
      // Right body side
      ctx.lineTo(cx + bodyWidth / 2, topY + bodyHeight - radius);
      ctx.quadraticCurveTo(
        cx + bodyWidth / 2,
        topY + bodyHeight,
        cx + bodyWidth / 2 - radius,
        topY + bodyHeight
      );
      // Bottom
      ctx.lineTo(cx - bodyWidth / 2 + radius, topY + bodyHeight);
      ctx.quadraticCurveTo(
        cx - bodyWidth / 2,
        topY + bodyHeight,
        cx - bodyWidth / 2,
        topY + bodyHeight - radius
      );
      // Left side and sleeve
      ctx.lineTo(cx - bodyWidth / 2, topY + 90);
      ctx.lineTo(cx - bodyWidth / 2 - sleeveWidth / 2 + 24, topY + 120);
      ctx.closePath();
      ctx.fill();
      ctx.stroke();

      // Subtle inner shading
      const grad = ctx.createLinearGradient(cx, topY, cx, topY + bodyHeight);
      grad.addColorStop(0, "rgba(0,0,0,0.18)");
      grad.addColorStop(0.4, "rgba(0,0,0,0.05)");
      grad.addColorStop(1, "rgba(0,0,0,0.12)");
      ctx.fillStyle = grad;
      ctx.beginPath();
      ctx.moveTo(cx - bodyWidth / 2 + 10, topY + 20);
      ctx.lineTo(cx + bodyWidth / 2 - 10, topY + 20);
      ctx.lineTo(cx + bodyWidth / 2 - 10, topY + bodyHeight - 10);
      ctx.lineTo(cx - bodyWidth / 2 + 10, topY + bodyHeight - 10);
      ctx.closePath();
      ctx.fill();

      ctx.restore();
    }

    // --- Drawing the design image ---
    function drawDesign() {
      if (!designImage || !designLoaded) return;

      const baseScale = designScale; // derived from slider / wheel
      const maxWidth = canvas.width * 0.5;
      const maxHeight = canvas.height * 0.5;

      // Fit natural size into a logical max, then apply user scale
      let drawWidth = imgNaturalWidth;
      let drawHeight = imgNaturalHeight;

      const ratio = Math.min(maxWidth / drawWidth, maxHeight / drawHeight, 1);
      drawWidth *= ratio * baseScale;
      drawHeight *= ratio * baseScale;

      const x = designCenter.x - drawWidth / 2;
      const y = designCenter.y - drawHeight / 2;

      ctx.save();
      ctx.imageSmoothingEnabled = true;
      ctx.imageSmoothingQuality = "high";
      ctx.drawImage(designImage, x, y, drawWidth, drawHeight);
      ctx.restore();

      // Store last drawn bounds for hit detection during drag
      designImage._bounds = { x, y, w: drawWidth, h: drawHeight };
    }

    function redraw() {
      drawShirtBase(shirtColor);
      drawDesign();
    }

    // --- Event Handlers ---

    shirtColorInput.addEventListener("input", (e) => {
      shirtColor = e.target.value;
      redraw();
    });

    imageUploadInput.addEventListener("change", (e) => {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function (ev) {
        const img = new Image();
        img.onload = function () {
          designImage = img;
          designLoaded = true;
          imgNaturalWidth = img.width;
          imgNaturalHeight = img.height;
          // Reset placement & scale
          designCenter = { x: canvas.width / 2, y: canvas.height / 2 };
          designScale = 1.0;
          imageScaleInput.value = 100;
          redraw();
        };
        img.src = ev.target.result;
      };
      reader.readAsDataURL(file);
    });

    imageScaleInput.addEventListener("input", (e) => {
      const val = parseInt(e.target.value, 10) || 100;
      // Map 20‚Äì200 range to 0.4‚Äì2.0 scale
      designScale = val / 100;
      redraw();
    });

    // Dragging logic
    function getMousePos(evt) {
      const rect = canvas.getBoundingClientRect();
      return {
        x: ((evt.clientX - rect.left) / rect.width) * canvas.width,
        y: ((evt.clientY - rect.top) / rect.height) * canvas.height,
      };
    }

    canvas.addEventListener("mousedown", (e) => {
      if (!designImage || !designImage._bounds) return;
      const pos = getMousePos(e);
      const b = designImage._bounds;
      if (pos.x >= b.x && pos.x <= b.x + b.w && pos.y >= b.y && pos.y <= b.y + b.h) {
        isDragging = true;
        dragOffset.x = pos.x - designCenter.x;
        dragOffset.y = pos.y - designCenter.y;
      }
    });

    window.addEventListener("mousemove", (e) => {
      if (!isDragging) return;
      const pos = getMousePos(e);
      designCenter.x = pos.x - dragOffset.x;
      designCenter.y = pos.y - dragOffset.y;
      redraw();
    });

    window.addEventListener("mouseup", () => {
      isDragging = false;
    });

    // Prevent accidental drag outside window if mouse leaves
    canvas.addEventListener("mouseleave", () => {
      isDragging = false;
    });

    // Scroll wheel to scale
    canvas.addEventListener(
      "wheel",
      (e) => {
        if (!designImage) return;
        e.preventDefault();
        const step = e.shiftKey ? 0.2 : 0.06;
        if (e.deltaY < 0) {
          designScale *= 1 + step;
        } else {
          designScale *= 1 - step;
        }
        designScale = Math.max(0.2, Math.min(designScale, 3.0));
        imageScaleInput.value = Math.round(designScale * 100);
        redraw();
      },
      { passive: false }
    );

    // Download
    downloadBtn.addEventListener("click", () => {
      redraw(); // ensure canvas is up to date
      const link = document.createElement("a");
      link.download = "tshirt-mockup.png";
      link.href = canvas.toDataURL("image/png");
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    });

    // Reset
    resetBtn.addEventListener("click", () => {
      shirtColor = "#ffffff";
      shirtColorInput.value = "#ffffff";
      designImage = null;
      designLoaded = false;
      imgNaturalWidth = 0;
      imgNaturalHeight = 0;
      designScale = 1.0;
      imageScaleInput.value = 100;
      designCenter = { x: canvas.width / 2, y: canvas.height / 2 - 40 };
      redraw();
    });

    // Initial draw
    redraw();
  </script>
</body>
</html>
